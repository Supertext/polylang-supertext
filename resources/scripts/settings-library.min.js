/*!
 * Supertext translation
 * https://wordpress.org/plugins/polylang-supertext/
 * @author Heinrich Muralt
 * @version 2.7.0
 * Copyright 2017 */
var Supertext=Supertext||{};Supertext.Settings={},Supertext.Settings.Users=function(e){"use strict";function t(){var e=o.clone();e.find(".remove-user-button").click(n),i.append(e)}function n(){e(this).parent("td").parent("tr").remove(),0===i.find("tr").length&&t()}var i,o;return{initialize:function(r){r=r||{},i=e("#tblStFields tbody"),i.find("tr .saved-user-id-hidden"),i.find("tr .remove-user-button").click(n),i.find("tr .saved-user-id-hidden").each(function(){var t=e(this);t.prev().val(t.val())}),o=e("#tblStFields tr:last").clone(),o.find("input").val(""),e("#btnAddUser").click(t)}}}(jQuery),Supertext.Settings.TranslatableFields=function(e){"use strict";var t=function(){function t(){var t=e(this),o=i.clone();o.children(".custom-field-remove-input").click(n),o.insertBefore(t).show()}function n(){e(this).parent().remove()}var i;return{initialize:function(o){i=e("#translatablefieldsSettingsForm .custom-field-input").last().clone(),e("#translatablefieldsSettingsForm .custom-field-remove-input").click(n),e("#translatablefieldsSettingsForm .custom-field-add-input").click(t)}}}(),n=function(){function t(){e.each(n,function(e,t){var n=t.jstree("get_checked",!1);i[e].val(n.join(","))})}var n={},i={};return{initialize:function(o){o=o||{};for(var r in savedFieldDefinitionIds)savedFieldDefinitionIds.hasOwnProperty(r)&&(n[r]=e("#fieldDefinitionsTree"+r),i[r]=e("#checkedFieldsInput"+r),n[r].jstree({core:{themes:{name:"wordpress-dark"}},plugins:["checkbox"],checkbox:{keep_selected_style:!1}}),n[r].jstree("select_node",savedFieldDefinitionIds[r]));e("#translatablefieldsSettingsForm").submit(t)}}}();return{initialize:function(e){e=e||{},t.initialize(e),n.initialize(e)}}}(jQuery),Supertext.Settings.Shortcodes=function(e){"use strict";function t(t,i,o){var c=t.data("lastIndex"),u=void 0===c?0:c+1,d=a({shortcodeIndex:u,name:i,contentEncoding:o}),l=e(d);t.append(l),t.data("lastIndex",u),l.children(".shortcode-remove-setting").click(function(){l.remove()}),l.find(".shortcode-attribute-add-input").click(function(){n(l.find(".shortcode-setting-attributes"),u)}),s(l),r(l)}function n(t,n,i,o){var r=t.data("lastIndex"),a=void 0===r?0:r+1,u=e(c({shortcodeIndex:n,attributeIndex:a,name:i,encoding:o}));t.append(u),t.data("lastIndex",a),u.children(".shortcode-attribute-remove-input").click(function(){u.remove()}),s(u)}function i(e){return e.split(/,\s*/)}function o(e){return i(e).pop()}function r(t){t.find(".shortcode-input-name").bind("keydown",function(t){t.keyCode===e.ui.keyCode.TAB&&e(this).autocomplete("instance").menu.active&&t.preventDefault()}).autocomplete({minLength:0,source:function(t,n){n(e.ui.autocomplete.filter(registeredShortcodes,t.term))}})}function s(t){t.find(".shortcode-input-encoding").bind("keydown",function(t){t.keyCode===e.ui.keyCode.TAB&&e(this).autocomplete("instance").menu.active&&t.preventDefault()}).autocomplete({minLength:0,source:function(t,n){n(e.ui.autocomplete.filter(availableEncodingFunctions,o(t.term)))},focus:function(){return!1},select:function(e,t){var n=i(this.value);return n.pop(),n.push(t.item.value),n.push(""),this.value=n.join(", "),!1}})}var a,c;return{initialize:function(i){i=i||{},a=i.template("sttr-shortcode-setting"),c=i.template("sttr-shortcode-attribute");var o=e("#shortcode-settings");e.each(savedShortcodes,function(i,r){t(o,i,r.content_encoding);var s=o.find(".shortcode-setting-container:last .shortcode-setting-attributes"),a=o.data("lastIndex");e.each(r.attributes,function(e,t){n(s,a,t.name,t.encoding)})}),e("#shortcodesSettingsForm .shortcode-add-setting").click(function(){t(o)})}}}(jQuery),Supertext.Settings.Workflow=function(e){"use strict";function t(){n.val(i.val()),i.children("option:last").is(":selected")?n.removeProp("readonly"):n.prop("readonly",!0)}var n,i;return{initialize:function(o){o=o||{},n=e("#sttr-api-url"),i=e("#sttr-api-selection"),i.change(t),t()}}}(jQuery),jQuery(document).ready(function(){var e=window.location.search,t=/tab=(.*?)(&|$|\s)/.exec(e),n=null===t?"users":t[1];switch(n){case"users":Supertext.Settings.Users.initialize();break;case"translatablefields":Supertext.Settings.TranslatableFields.initialize();break;case"shortcodes":Supertext.Settings.Shortcodes.initialize({template:wp.template});break;case"workflow":Supertext.Settings.Workflow.initialize()}});