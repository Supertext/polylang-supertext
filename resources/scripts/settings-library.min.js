/*!
 * Supertext translation
 * https://wordpress.org/plugins/polylang-supertext/
 * @author Heinrich Muralt
 * @version 1.9.0
 * Copyright 2016 */
var Supertext=Supertext||{};Supertext.Settings={},Supertext.Settings.Users=function(e){"use strict";function t(){var e=r.clone();e.find(".remove-user-button").click(n),i.append(e)}function n(){e(this).parent("td").parent("tr").remove(),0===i.find("tr").length&&t()}var i,r;return{initialize:function(o){o=o||{},i=e("#tblStFields tbody"),i.find("tr .saved-user-id-hidden"),i.find("tr .remove-user-button").click(n),i.find("tr .saved-user-id-hidden").each(function(){var t=e(this);t.prev().val(t.val())}),r=e("#tblStFields tr:last").clone(),r.find("input").val(""),e("#btnAddUser").click(t)}}}(jQuery),Supertext.Settings.TranslatableFields=function(e){"use strict";var t=function(){function t(){var t=e(this),r=i.clone();r.children(".custom-field-remove-input").click(n),r.insertBefore(t).show()}function n(){e(this).parent().remove()}var i;return{initialize:function(r){i=e("#translatablefieldsSettingsForm .custom-field-input").last().clone(),e("#translatablefieldsSettingsForm .custom-field-remove-input").click(n),e("#translatablefieldsSettingsForm .custom-field-add-input").click(t)}}}(),n=function(){function t(){var e=n.jstree("get_checked",!1);i.val(e.join(","))}var n,i;return{initialize:function(r){r=r||{},n=e("#pcfFieldsTree"),0!==n.length&&(i=e("#checkedPcfFieldsInput"),n.jstree({core:{themes:{name:"wordpress-dark"}},plugins:["checkbox"],checkbox:{keep_selected_style:!1}}),n.jstree("select_node",savedPcfFields),e("#translatablefieldsSettingsForm").submit(t))}}}(),i=function(){function t(){var e=n.jstree("get_checked",!1);i.val(e.join(","))}var n,i;return{initialize:function(r){r=r||{},n=e("#acfFieldsTree"),0!==n.length&&(i=e("#checkedAcfFieldsInput"),n.jstree({core:{themes:{name:"wordpress-dark"}},plugins:["checkbox"],checkbox:{keep_selected_style:!1}}),n.jstree("select_node",savedAcfFieldIds),e("#translatablefieldsSettingsForm").submit(t))}}}();return{initialize:function(e){e=e||{},t.initialize(e),n.initialize(e),i.initialize(e)}}}(jQuery),Supertext.Settings.Shortcodes=function(e){"use strict";function t(t,i,r){var a=t.data("lastIndex"),u=void 0===a?0:a+1,l=c({shortcodeIndex:u,name:i,contentEncoding:r}),d=e(l);t.append(d),t.data("lastIndex",u),d.children(".shortcode-remove-setting").click(function(){d.remove()}),d.find(".shortcode-attribute-add-input").click(function(){n(d.find(".shortcode-setting-attributes"),u)}),s(d),o(d)}function n(t,n,i,r){var o=t.data("lastIndex"),c=void 0===o?0:o+1,u=e(a({shortcodeIndex:n,attributeIndex:c,name:i,encoding:r}));t.append(u),t.data("lastIndex",c),u.children(".shortcode-attribute-remove-input").click(function(){u.remove()}),s(u)}function i(e){return e.split(/,\s*/)}function r(e){return i(e).pop()}function o(t){t.find(".shortcode-input-name").bind("keydown",function(t){t.keyCode===e.ui.keyCode.TAB&&e(this).autocomplete("instance").menu.active&&t.preventDefault()}).autocomplete({minLength:0,source:function(t,n){n(e.ui.autocomplete.filter(registeredShortcodes,t.term))}})}function s(t){t.find(".shortcode-input-encoding").bind("keydown",function(t){t.keyCode===e.ui.keyCode.TAB&&e(this).autocomplete("instance").menu.active&&t.preventDefault()}).autocomplete({minLength:0,source:function(t,n){n(e.ui.autocomplete.filter(availableEncodingFunctions,r(t.term)))},focus:function(){return!1},select:function(e,t){var n=i(this.value);return n.pop(),n.push(t.item.value),n.push(""),this.value=n.join(", "),!1}})}var c,a;return{initialize:function(i){i=i||{},c=i.template("sttr-shortcode-setting"),a=i.template("sttr-shortcode-attribute");var r=e("#shortcode-settings");e.each(savedShortcodes,function(i,o){t(r,i,o.content_encoding);var s=r.find(".shortcode-setting-container:last .shortcode-setting-attributes"),c=r.data("lastIndex");e.each(o.attributes,function(e,t){n(s,c,t.name,t.encoding)})}),e("#shortcodesSettingsForm .shortcode-add-setting").click(function(){t(r)})}}}(jQuery),Supertext.Settings.Workflow=function(e){"use strict";function t(){n.val(i.val()),i.children("option:last").is(":selected")?n.removeProp("readonly"):n.prop("readonly",!0)}var n,i;return{initialize:function(r){r=r||{},n=e("#sttr-api-url"),i=e("#sttr-api-selection"),i.change(t),t()}}}(jQuery),jQuery(document).ready(function(){var e=window.location.search,t=/tab=(.*?)(&|$|\s)/.exec(e),n=null===t?"users":t[1];switch(n){case"users":Supertext.Settings.Users.initialize();break;case"translatablefields":Supertext.Settings.TranslatableFields.initialize();break;case"shortcodes":Supertext.Settings.Shortcodes.initialize({template:wp.template});break;case"workflow":Supertext.Settings.Workflow.initialize()}});